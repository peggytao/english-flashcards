<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>English Flashcards App</title>
<style>
body { margin:0; font-family:Arial,sans-serif; background:#f4f4f9; color:#333; display:flex; min-height:100vh;}
/* æ¼¢å ¡æŒ‰éˆ• */
.menu-toggle {position:fixed; top:15px; left:15px; z-index:1100; background:#3a3a5c; color:#fff; border:none; padding:10px 12px; border-radius:6px; cursor:pointer; font-size:18px; display:none;}
/* å´é‚Šæ¬„ */
.sidebar {position:fixed; top:0; left:0; width:220px; height:100%; background:#3a3a5c; color:#fff; padding-top:60px; transition:transform 0.3s ease; box-shadow:2px 0 6px rgba(0,0,0,0.2);}
.sidebar a {display:block; padding:12px 20px; color:#fff; text-decoration:none; margin-bottom:5px; border-radius:5px;}
.sidebar a:hover {background:#57578b;}
.sidebar.hidden {transform:translateX(-100%);}
.sidebar.show {transform:translateX(0);}

/* ä¸»å…§å®¹ */
.main {flex:1; margin-left:220px; padding:15px; transition:margin-left 0.3s ease; max-width:1000px;}
header {text-align:center; padding:15px; font-size:20px; font-weight:bold; background:#3a3a5c; color:#fff; border-radius:8px; margin-bottom:10px;}

/* å¡ç‰‡æ¨£å¼ */
.card {background:#fff; padding:15px; border-radius:10px; margin:10px 0; box-shadow:0 3px 6px rgba(0,0,0,0.1); text-align:center;}
.big {font-size:22px; font-weight:bold; margin-bottom:10px;}
input, button {width:100%; padding:10px; margin:5px 0; border-radius:6px; border:1px solid #ccc; box-sizing:border-box;}
button {background:#3a3a5c; color:#fff; border:none; cursor:pointer; transition:0.2s;}
button:hover {background:#57578b;}
.word-list li {background:#fff; padding:10px; border-radius:8px; margin:5px 0; display:flex; justify-content:space-between; align-items:center; box-shadow:0 2px 4px rgba(0,0,0,0.1);}
.word-list button {width:auto; padding:5px 8px; background:#e74c3c; margin:0;}

/* æ‰‹æ©Ÿæ¨£å¼ */
@media(max-width:768px){
  .main{margin-left:0;}
  .menu-toggle{display:block;}
  .sidebar{width:200px; transform:translateX(-100%);}
  .sidebar.show{transform:translateX(0);}
}
</style>
</head>
<body>

<!-- æ¼¢å ¡æŒ‰éˆ• -->
<button class="menu-toggle" onclick="toggleSidebar()">â˜° Menu</button>

<!-- å´é‚Šæ¬„ -->
<div class="sidebar" id="sidebar">
  <a href="javascript:void(0)" onclick="showSection('add')">æ–°å¢å–®å­—</a>
  <a href="javascript:void(0)" onclick="showSection('quiz')">æŠ½è€ƒ</a>
  <a href="javascript:void(0)" onclick="showSection('list')">å·²å­˜å–®å­—</a>
  <a href="/">å›é¦–é </a>
</div>

<!-- ä¸»å…§å®¹ -->
<div class="main">
  <header>ğŸ“š English Flashcards</header>

  <!-- æ–°å¢å–®å­—å€ -->
  <div class="card section" id="add">
    <input id="english" placeholder="è¼¸å…¥è‹±æ–‡å–®å­—">
    <button onclick="translateWord()">è‡ªå‹•ç¿»è­¯</button>
    <button onclick="speakWord()">ğŸ”Š ç™¼éŸ³</button>
    <button onclick="saveWord()">ğŸ’¾ æ–°å¢å„²å­˜</button>
    <div id="result" class="big"></div>
  </div>

  <!-- æŠ½è€ƒå€ -->
  <div class="card section" id="quiz" style="display:none">
    <div id="quizWord" class="big">ğŸ² é»æ“ŠæŠ½è€ƒ</div>
    <button onclick="randomWord()">éš¨æ©ŸæŠ½è€ƒ</button>
    <button onclick="showAnswer()">é¡¯ç¤ºç­”æ¡ˆ</button>
  </div>

  <!-- å–®å­—åˆ—è¡¨ -->
  <div class="card section" id="list" style="display:none">
    <h3>å·²å­˜å–®å­—</h3>
    <ul id="wordList" class="word-list"></ul>
  </div>
</div>

<script>
let words = JSON.parse(localStorage.getItem("words")) || [];
let currentTranslation = "";
let currentQuizIndex = null;

// æ¼¢å ¡å´é‚Šæ¬„
function toggleSidebar(){ document.getElementById('sidebar').classList.toggle('show'); }

// åˆ‡æ›ä¸»å…§å®¹å€
function showSection(sectionId){
  document.querySelectorAll('.section').forEach(s=>s.style.display='none');
  document.getElementById(sectionId).style.display='block';
  if(window.innerWidth<=768) toggleSidebar();
}

// å„²å­˜ localStorage
function saveStorage(){ localStorage.setItem("words", JSON.stringify(words)); }

// è‡ªå‹•ç¿»è­¯
async function translateWord(){
  const eng=document.getElementById("english").value;
  if(!eng) return;
  try{
    const response=await fetch(`https://api.mymemory.translated.net/get?q=${encodeURIComponent(eng)}&langpair=en|zh-CN`);
    const data=await response.json();
    currentTranslation=data.responseData.translatedText;
    document.getElementById("result").innerText=eng+" = "+currentTranslation;
  }catch(err){
    currentTranslation="ç¿»è­¯å¤±æ•—";
    document.getElementById("result").innerText=eng+" = "+currentTranslation;
  }
}

// ç™¼éŸ³
function speakWord(word=document.getElementById("english").value){
  if(!word) return;
  const utter=new SpeechSynthesisUtterance(word);
  utter.lang="en-US";
  speechSynthesis.speak(utter);
}

// æ–°å¢å–®å­—
function saveWord(){
  const eng=document.getElementById("english").value;
  if(!eng || !currentTranslation) return;
  words.push({eng,chi:currentTranslation,score:0});
  saveStorage();
  renderList();
  document.getElementById("english").value="";
  document.getElementById("result").innerText="";
}

// æ¸²æŸ“å–®å­—åˆ—è¡¨
function renderList(){
  const list=document.getElementById("wordList");
  list.innerHTML="";
  words.forEach((w,i)=>{
    list.innerHTML+=`<li>${w.eng} - ${w.chi} <button onclick="deleteWord(${i})">âŒ</button></li>`;
  });
}

// åˆªé™¤å–®å­—
function deleteWord(i){ words.splice(i,1); saveStorage(); renderList(); }

// éš¨æ©ŸæŠ½è€ƒï¼ˆé–“éš”é‡è¤‡æ¨¡å¼ï¼‰
function randomWord(){
  if(words.length===0) return;
  // è¨ˆç®—æ¯å€‹å–®å­—æ¬Šé‡ = maxScore - score
  const maxScore = 5;
  const pool = [];
  words.forEach((w,i)=>{
    const weight = maxScore - (w.score||0);
    for(let j=0;j<weight;j++) pool.push(i);
  });
  currentQuizIndex = pool[Math.floor(Math.random()*pool.length)];
  const word = words[currentQuizIndex].eng;
  document.getElementById("quizWord").innerText = word;
  speakWord(word); // è‡ªå‹•ç™¼éŸ³
}

// é¡¯ç¤ºç­”æ¡ˆä¸¦å¢åŠ åˆ†æ•¸
function showAnswer(){
  if(currentQuizIndex===null) return;
  const w = words[currentQuizIndex];
  document.getElementById("quizWord").innerText = w.eng + " = " + w.chi;
  if(w.score<5) w.score++;
  saveStorage();
  renderList();
}

// åˆå§‹æ¸²æŸ“
renderList();
</script>

</body>
</html>
